{% extends "base.html" %}

{% block title %}Perfil de {{ veterano.nombre }} {{ veterano.apellido }}{% endblock %}

{% block content %}
<div class="container px-3 px-md-4 py-4">
    {% if veterano %}
    <article class="card shadow-sm border-0">
        <div class="card-header text-white py-3" style="background-color: #0066CC;">
            <h1 class="h3 mb-0">Perfil del Veterano</h1>
        </div>
        <div class="card-body p-3 p-md-4">
            <div class="row g-3 g-md-4">
                <!-- Profile Image -->
                <div class="col-12 col-md-3 text-center">
                    <img src="{{ url_for('static', filename='img/avatar.svg') }}" 
                          class="img-fluid rounded-circle shadow-sm" 
                          alt="Avatar por defecto"
                          style="max-width: 200px; width: 100%; height: auto; aspect-ratio: 1/1; object-fit: cover;">
                </div>

                <!-- Profile Info -->
                <div class="col-12 col-md-9">
                    <h2 class="h4 fw-bold mb-3">{{ veterano.apellido }}, {{ veterano.nombre }}</h2>
                    <hr>
                    <dl class="row g-2 mb-0">
                        <dt class="col-5 col-sm-4">Fuerza:</dt>
                        <dd class="col-7 col-sm-8">{{ veterano.fuerza or 'No especificada' }}</dd>
                        
                        <dt class="col-5 col-sm-4">Lugar de Nacimiento:</dt>
                        <dd class="col-7 col-sm-8">
                            {{ veterano.nombre_localidad or 'N/A' }}{% if veterano.departamento %}, {{ veterano.departamento }}{% endif %}{% if veterano.provincia_nacimiento %}, {{ veterano.provincia_nacimiento }}{% endif %}
                        </dd>
                        
                        <dt class="col-5 col-sm-4">Estado:</dt>
                        <dd class="col-7 col-sm-8">
                            {% if veterano.fecha_fallecimiento %}
                                <span class="badge bg-secondary">Fallecido</span>
                            {% else %}
                                <span class="badge bg-success">Vive</span>
                            {% endif %}
                        </dd>
                        
                        {% if current_user.is_authenticated and veterano_admin %}
                        <dt class="col-12 mt-3"><hr><h5 class="mb-0" style="color: #0066CC;">Información Adicional</h5></dt>
                        
                        <dt class="col-5 col-sm-4">DNI:</dt>
                        <dd class="col-7 col-sm-8">{{ request.view_args['dni'] }}</dd>
                        
                        <dt class="col-5 col-sm-4">Fecha de Nacimiento:</dt>
                        <dd class="col-7 col-sm-8">{{ veterano.fecha_nacimiento.strftime('%d/%m/%Y') if veterano.fecha_nacimiento else 'No especificada' }}</dd>
                        
                        <dt class="col-5 col-sm-4">Correo Electrónico:</dt>
                        <dd class="col-7 col-sm-8">{{ veterano_admin.mail or 'No especificado' }}</dd>
                        
                        {% if telefonos %}
                        <dt class="col-5 col-sm-4">Teléfonos:</dt>
                        <dd class="col-7 col-sm-8">
                            <ul class="list-unstyled mb-0">
                                {% for tel in telefonos %}
                                    <li>{{ tel.telefono }}</li>
                                {% endfor %}
                            </ul>
                        </dd>
                        {% endif %}

                        <dt class="col-5 col-sm-4">Dirección:</dt>
                        <dd class="col-7 col-sm-8">{{ veterano_admin.direccion or 'No especificada' }}</dd>
                        
                        <dt class="col-5 col-sm-4">Residencia:</dt>
                        <dd class="col-7 col-sm-8">{{ veterano_admin.localidad_residencia or 'N/A' }}{% if veterano_admin.provincia_residencia %}, {{ veterano_admin.provincia_residencia }}{% endif %}</dd>
                        
                        <dt class="col-5 col-sm-4">Grado:</dt>
                        <dd class="col-7 col-sm-8">{{ veterano_admin.grado or 'No especificado' }}</dd>
                        
                        <dt class="col-5 col-sm-4">Función:</dt>
                        <dd class="col-7 col-sm-8">{{ veterano_admin.funcion or 'No especificada' }}</dd>
                        
                        <dt class="col-5 col-sm-4">Nro. Beneficio:</dt>
                        <dd class="col-7 col-sm-8">{{ veterano_admin.nro_beneficio_nacional or 'No especificado' }}</dd>

                        {% if veterano.fecha_fallecimiento %}
                        <dt class="col-5 col-sm-4">Causa Fallecimiento:</dt>
                        <dd class="col-7 col-sm-8">{{ veterano_admin.causa_fallecimiento or 'No especificada' }}</dd>
                        {% endif %}

                        {% if veterano_admin.secuelas %}
                        <dt class="col-5 col-sm-4">Secuelas:</dt>
                        <dd class="col-7 col-sm-8">{{ veterano_admin.secuelas }}</dd>
                        {% endif %}
                        {% endif %}
                    </dl>
                </div>
            </div>
        </div>
    </article>
    {% else %}
    <div class="alert alert-danger text-center" role="alert">
        No se pudo encontrar la información para la persona solicitada.
    </div>
    {% endif %}

    <div class="text-center mt-4">
        <a href="{{ url_for('main.buscar') }}" class="btn btn-primary">
            <i class="bi bi-arrow-left me-2"></i>Volver a la búsqueda
        </a>
    </div>
</div>
{% endblock %}
